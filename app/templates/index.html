{% extends "base.html" %}
{% import "bootstrap_wtf.html" as wtf %}

{% block content %}
    <h1>Hi, {{ current_user.username }}!</h1>

    {{ wtf.quick_form(form) }}

    {% for post in posts %}
    <div><p>{{ post.author.username }} says: <b>{{ post.body }}</b></p></div>
    {% endfor %}

    {{ wtf.quick_form(filter_form) }}

    <script>
        let my_select = document.getElementById("my");
        let onload = function() {
            let url = new URL(location.href);
            if (url.searchParams.get("my") == "on") {
                my_select.checked = true;
            }
        };
        onload();

        update = function() {
            let url = new URL(location.href);
            if (my_select.checked) {
                url.searchParams.set("my", "on");
            } else {
                url.searchParams.delete("my");
            }
            if (url.toString() != location.href) {
                location.href = url.toString();
            }
        };
        my_select.onchange = update;
    </script>

{% endblock %}
